---
import type { CollectionEntry } from 'astro:content'
import { getCollection } from 'astro:content'
import UpdateCard from '@/components/ui/UpdateCard.astro'

interface Props {
  data?: CollectionEntry<'restricted'>[]
}

const { data } = Astro.props

const restrictedUpdates =
  data !== undefined
    ? data
    : await getCollection('restricted').then((posts) =>
        posts.sort(
          (a, b) => b.data.updatedAt.getTime() - a.data.updatedAt.getTime(),
        ),
      )
---

{
  restrictedUpdates.map((post) => (
    <UpdateCard
      title={post.data.title}
      description={post.data.description}
      tag={post.data.tag}
      date={post.data.updatedAt}
      slug={post.id}
      type="restricted"
    />
  ))
}
